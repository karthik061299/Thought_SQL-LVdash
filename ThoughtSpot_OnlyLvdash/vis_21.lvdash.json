{
  "version": "1.0",
  "metadata": {
    "name": "% Active Devices by Appversion",
    "description": "Bar chart showing percentage of active devices by app version",
    "created_by": "ThoughtSpot Migration Agent",
    "created_at": "2024-01-01T00:00:00Z",
    "tags": ["mobile", "app_version", "active_devices", "percentage"]
  },
  "datasets": [
    {
      "name": "hpx_events_model_dataset",
      "displayName": "HPX Events Model Dataset",
      "query": "SELECT app_version, active_devices_1 as active_devices, (active_devices_1 * 100.0 / SUM(active_devices_1) OVER ()) as pct_active_devices_by_appversion FROM team_css_analytics_prod.hpx_analytics.hpx_events_model_iide_metric_view WHERE app_version IS NOT NULL AND app_version NOT IN ('not a store release', 'other non-releases') AND event_date_time >= '2023-05-01' AND os_version IS NOT NULL GROUP BY app_version, active_devices_1 ORDER BY pct_active_devices_by_appversion DESC"
    }
  ],
  "pages": [
    {
      "name": "Page 1",
      "displayName": "% Active Devices by Appversion",
      "layout": {
        "position": {
          "x": 0,
          "y": 0,
          "width": 6,
          "height": 4
        }
      },
      "spec": {
        "version": "1.0",
        "datasets": [
          {
            "name": "hpx_events_model_dataset",
            "displayName": "HPX Events Model Dataset"
          }
        ],
        "fields": [
          {
            "name": "app_version",
            "displayName": "App Version",
            "datasetName": "hpx_events_model_dataset",
            "type": "string"
          },
          {
            "name": "pct_active_devices_by_appversion",
            "displayName": "% Active Devices By Appversion",
            "datasetName": "hpx_events_model_dataset",
            "type": "number"
          }
        ],
        "encodings": {
          "x": {
            "fieldName": "app_version",
            "displayName": "App Version",
            "scale": {
              "type": "categorical"
            }
          },
          "y": {
            "fieldName": "pct_active_devices_by_appversion",
            "displayName": "% Active Devices By Appversion",
            "scale": {
              "type": "quantitative"
            },
            "format": {
              "type": "percentage",
              "decimals": 1
            }
          }
        },
        "mark": {
          "type": "bar",
          "tooltip": true
        },
        "config": {
          "view": {
            "stroke": "transparent"
          },
          "axis": {
            "domainWidth": 1,
            "grid": true,
            "labelFontSize": 11,
            "titleFontSize": 12
          },
          "bar": {
            "color": "#0096D3"
          },
          "legend": {
            "labelFontSize": 11,
            "titleFontSize": 12
          }
        },
        "title": {
          "text": "% Active Devices by Appversion",
          "fontSize": 14,
          "fontWeight": "bold",
          "anchor": "start"
        },
        "width": 600,
        "height": 400
      }
    }
  ],
  "filters": [
    {
      "name": "app_version_filter",
      "displayName": "App Version Filter",
      "field": "app_version",
      "type": "exclude",
      "values": ["not a store release", "other non-releases"]
    },
    {
      "name": "date_filter",
      "displayName": "Event Date Filter",
      "field": "event_date_time",
      "type": "date_range",
      "values": ["2023-05-01", null]
    },
    {
      "name": "os_version_filter",
      "displayName": "OS Version Filter",
      "field": "os_version",
      "type": "not_null"
    }
  ],
  "parameters": [],
  "refresh": {
    "enabled": true,
    "interval": "1h"
  }
}